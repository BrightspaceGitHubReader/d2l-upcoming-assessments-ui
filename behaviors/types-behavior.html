<link rel="import" href="../../d2l-hm-constants-behavior/d2l-hm-constants-behavior.html">
<link rel="import" href="./status-badge-behavior.html">

<script>
	'use strict';

	window.D2L = window.D2L || {};
	window.D2L.UpcomingAssessments = window.D2L.UpcomingAssessments || {};

	/*
	* @polymerBehavior window.D2L.UpcomingAssessments.TypesBehavior
	*/
	var typesBehaviorImpl = {
		properties: {
			_types: {
				type: Object,
				value: function() {
					return {
						assignment: {
							icon: 'assignments',
							assessmentType: 'assignment',
							canOpen: true,
							instructionsRel: this.HypermediaRels.Assignments.instructions,
							userActivityUsageClass: this.HypermediaClasses.activities.userAssignmentActivity,
							activityRel: this.HypermediaRels.assignment,
							activityClass: this.HypermediaClasses.assignments.assignment,
							noCompletion: false
						},
						discussion: {
							icon: 'discussions',
							assessmentType: 'discussion',
							canOpen: true,
							instructionsRel: this.HypermediaRels.Discussions.description,
							userActivityUsageClass: this.HypermediaClasses.activities.userDiscussionActivity,
							activityRel: this.HypermediaRels.Discussions.topic,
							activityClass: this.HypermediaClasses.discussions.topic,
							noCompletion: true
						},
						quiz: {
							icon: 'quizzing',
							assessmentType: 'quiz',
							canOpen: false,
							instructionsRel: this.HypermediaRels.Quizzes.description,
							userActivityUsageClass: this.HypermediaClasses.activities.userQuizActivity,
							activityRel: this.HypermediaRels.quiz,
							activityClass: this.HypermediaClasses.quizzes.quiz,
							noCompletion: false
						}
					};
				}
			}
		},

		_allTypes: ['assignment', 'discussion', 'quiz'],

		_getActivityType: function(activity) {
			for (var i = 0; i < this._allTypes.length; i++) {
				var typeName = this._allTypes[i];
				var type = this._types[typeName];
				if (activity.hasClass(type.activityClass)) {
					return typeName;
				}
			}
			return undefined;
		},

		_canOpenItemType: function(assessmentItem) {
			var item = this._types[(assessmentItem || {}).type];
			return !!((item || {}).canOpen);
		}
	};

	window.D2L.UpcomingAssessments.TypesBehavior = [
		window.D2L.Hypermedia.HMConstantsBehavior,
		window.D2L.UpcomingAssessments.StatusBadgeBehavior,
		typesBehaviorImpl
	];

</script>
